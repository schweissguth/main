
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>SF bed</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1">



    <script
      type="text/javascript"
      src="/js/lib/dummy.js"
      
    ></script>



    <style id="compiled-css" type="text/css">
      

      /* EOS */
    </style>

    <style type="text/css">
      :root {
        color-scheme: light;
      }
    </style>
	  
	  <link rel="stylesheet" type="text/css" href="./css.css" />


  </head>
  <body>
    <center>
      <br /><br />

      <a href="../" class="banner" width="100%">
        <img src="./sfbanner.png" width="100%" />
      </a>

      <br /><br />
  <select id="select" onchange="getScores(this.value)">
    <option id="option" disabled selected>LOADING...</option>
  </select>

  <br /><br />

  <table>
    <thead id="thead" style="display: none">
      <tr>
        <th></th>
        <th></th>
        <th></th>
        <th>Pos1</th>
        <th>Pos2</th>
        <th>Pts1</th>
        <th>Pts2</th>
        <th>B</th>
        <th>Sum</th>
      </tr>
    </thead>
    <tbody id="table"></tbody>
  </table>
</center>

  </body>

    <script type="text/javascript">




fetch("https://script.google.com/macros/s/AKfycbyEGYd3C0Zgd-mHbBrjDrdMUSsYvj_7oky1yIuffDrRk8rURlR-gV_IteIJHzznntfO/exec?SCHEDULE").then(function(schedules) {
	return schedules.json()
}).then(function(schedules) {
	console.log(schedules)
  schedules = schedules.filter(function(schedule) {
  	return schedule.is_qualifying_race == false
  })
  option.text = "Select race"
  schedules.forEach(function(schedule) {
  	var opt = document.createElement("OPTION")
    opt.text = schedule.track_name + " (" + schedule.race_id + ")"
    opt.value = schedule.race_id
    select.add(opt)
  })
})


function getScores(x) {
	thead.style.display = ""
  table.innerHTML = null
	fetch("https://script.google.com/macros/s/AKfycbyEGYd3C0Zgd-mHbBrjDrdMUSsYvj_7oky1yIuffDrRk8rURlR-gV_IteIJHzznntfO/exec?SCORES=" + x).then(function(scores) {
  	return scores.json()
  }).then(function(scores) {
  	console.log(scores)
    scores.sort(function(a, b) {
    	return b.SUM - a.SUM
    })
    thead.style.display = "none"
    scores.forEach(function(score) {
    	var tr = table.insertRow()
      tr.insertCell().innerHTML = "<b>" + score.NAME + "</b>"
      tr.insertCell().innerText = score.DRIVERNAME1
      tr.insertCell().innerText = score.DRIVERNAME2
      tr.insertCell().innerText = score.POS1
      tr.insertCell().innerText = score.POS2
      tr.insertCell().innerText = score.PTS1
      tr.insertCell().innerText = score.PTS2
      tr.insertCell().innerText = score.B1 + score.B2 || ""
      tr.insertCell().innerText = score.SUM
      
    })
  })
}





  </script>

  <script>
    // tell the embed parent frame the height of the content
    if (window.parent && window.parent.parent){
      window.parent.parent.postMessage(["resultsFrame", {
        height: document.body.getBoundingClientRect().height,
        slug: "73kwe8mp"
      }], "*")
    }

    // always overwrite window.name, in case users try to set it manually
    window.name = "result"
  </script>

  <script>
    const allLines = []
    const cssElement = document.querySelector("#compiled-css")

    window.addEventListener("message", (message) => {

      if (message.data.css){
        cssElement.textContent = message.data.css.payload
      }

      if (message.data.html){
        document.body.innerHTML = message.data.html.payload
      }
    })
  </script>
</html>
