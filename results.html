
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Results - StupidFast</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script
    type="text/javascript"
    src="/js/lib/dummy.js"
    
  ></script>

    <link rel="stylesheet" type="text/css" href="css.css">


  <style id="compiled-css" type="text/css">
    

    /* EOS */
  </style>

  <script id="insert"></script>

</head>
<body>

<center>
      <a href="../" class="banner" width="100%">
        <img src="./sfbanner.png" width="100%" />
      </a>

      <br /><br />
  <select id="select" onchange="getRaceResults(this.value)">
    <option id="option" disabled selected>LOADING...</option>
  </select>

  <br /><br />

  <table>
    <thead id="thead" style="display: none">
      <tr>
        <th>LOADING...</th>
      </tr>
    </thead>
    <tbody id="table"></tbody>
  </table>
</center>


    <script type="text/javascript">

	    


fetch("https://script.google.com/macros/s/AKfycbyEGYd3C0Zgd-mHbBrjDrdMUSsYvj_7oky1yIuffDrRk8rURlR-gV_IteIJHzznntfO/exec?SCHEDULE").then(function(schedules) {
	return schedules.json()
}).then(function(schedules) {
	console.log(schedules)
  schedules = schedules.filter(function(schedule) {
  	return schedule.is_qualifying_race == false
  })
  option.text = "Select race"
  schedules.forEach(function(schedule) {
  	var opt = document.createElement("OPTION")
    opt.text = schedule.track_name + " (" + schedule.race_id + ")"
    opt.value = schedule.race_id
    select.add(opt)
  })
})


function getRaceResults(x) {
	thead.style.display = ""
  table.innerHTML = null
	fetch("https://script.google.com/macros/s/AKfycbyEGYd3C0Zgd-mHbBrjDrdMUSsYvj_7oky1yIuffDrRk8rURlR-gV_IteIJHzznntfO/exec?RACERESULTS=" + x).then(function(raceresults) {
  	return raceresults.json()
  }).then(function(raceresults) {
  	console.log(raceresults)
    thead.style.display = "none"
    raceresults.weekend_race[0].results = raceresults.weekend_race[0].results.filter(function(raceresult) {
    	return raceresult.finishing_position
    })
    raceresults.weekend_race[0].results.forEach(function(raceresult) {
    	var tr = table.insertRow()
      tr.insertCell().innerText = raceresult.finishing_position
      tr.insertCell().innerText = raceresult.driver_fullname
      tr.insertCell().innerText = raceresult.diff_time/1000 || "-" + raceresult.diff_laps
      tr.insertCell().innerHTML = "<i>" + raceresult.PLAYER + "</i>"
    })
  })
}
  </script>


</body>
</html>
