



<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Results - StupidFast</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script
    type="text/javascript"
    src="/js/lib/dummy.js"
    
  ></script>

    <link rel="stylesheet" type="text/css" href="css.css">


  <style id="compiled-css" type="text/css">
    

    /* EOS */
  </style>
<script src="https://stupid-fast.com/library.js"></script>

</head>
<body>

<center>
	<br><br>
<a href="https://stupid-fast.com">
  <img src="https://stupid-fast.com/sfbanner.png" alt="">
</a>

<br><br>


<select id="selectrace" onchange="selectRace(this.value)">
  <option id="option">LOADING...</option>
</select>

<br><br>

<table id="table" cellpadding="3">
  <thead>
    <tr>
      <!--th id="th">SELECT RACE...</th-->
    </tr>
  </thead>
  <tbody id="tbody"></tbody>
</table>

</center>
  



    <script type="text/javascript">
	    const schedule = []

getSchedule().then(function (res) {
  console.log(res)
  option.text = "Select race..."
  option.disabled = true
  res.forEach(function (race, n) {
    schedule.push(race)
    let opt = document.createElement("OPTION")
    opt.value = race.race_id
    opt.text = race.track_name
    + " - " + new Date(race.date_scheduled).toUTCString().split("2025")[0] + " " 
    + new Date(race.date_scheduled).toLocaleTimeString().replace(":00 PM", "PM")
    + ", " + race.television_broadcaster + " & " + race.radio_broadcaster
    + " (" + race.race_id + ")"
    selectrace.append(opt)
  })
  selectrace.value = res.find(function(race) {
    return !race.winner_driver_id
  })?.race_id
})

function selectRace(x) {
  tbody.innerHTML = "<tr><th>LOADING...</th></tr>"
  let findrace = schedule.find(function (race) {
    return race.race_id == x
  })
  if (findrace.winner_driver_id) {
    getResults(x).then(function (res) {
      console.log("results", res)
      res = res.filter(function(driver) {
        return driver.finishing_position > 0
      })
      tbody.innerHTML = null
      res.forEach(function(driver) {
        let tr = tbody.insertRow()
        tr.insertCell().innerText = driver.finishing_position
        tr.insertCell().innerText = driver.driver_fullname
        let td = tr.insertCell()
        td.innerText = driver.score.playername || ""
        td.style.fontWeight = "bold"
        td = tr.insertCell()
        td.innerText = driver.score.PTS || ""
        if (driver.score.B > 0) {
          td.innerText += "+" + driver.score.B
        }
      })

    })
  } else {
    console.log(findrace)
    tbody.innerHTML = null
  }
}


  </script>


</body>
</html>
